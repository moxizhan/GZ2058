<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <!-- <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script> -->

    <script src="https://cdn.staticfile.org/react/17.0.1/umd/react.production.min.js"></script>
    <script src="https://cdn.staticfile.org/react-dom/17.0.1/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
  </head>

  <body>
    <div id="app"></div>

    <script type="text/babel">
      const { Component, useState, useEffect } = React;

      // function User(props) {
      //   return <p>name: {}</p>;
      // }

      // class User extends Component {
      //   constructor(props) {
      //     super(props);
      //   }

      //   componentWillMount() {
      //     console.log("componentWillMount");
      //   }

      //   componentDidMount() {
      //     console.log("componentDidMount");

      //     console.log('Ajax 获取数据', this.props.msg);
      //   }

      //   componentWillReceiveProps(nextProps) {
      //     console.log("componentWillReceiveProps");
      //   }
      //   componentWillUpdate(nextProps, nextState) {
      //     console.log("componentWillUpdate");
      //   }

      //   // shouldComponentUpdate(nextProps, nextState) {
      //   //   if (nextProps.user.name !== this.props.user.name) {
      //   //     return true;
      //   //   } else {
      //   //     return false;
      //   //   }
      //   // }

      //   componentDidUpdate(prevProps, prevState) {
      //     console.log("componentDidUpdate");

      //     console.log('Ajax 获取数据', this.props.msg);
      //   }

      //   componentWillUnmount() {
      //     console.log("componentWillUnmount");
      //   }

      //   render() {
      //     return <p>name: {this.props.user.name}</p>;
      //   }
      // }

      function User(props) {
        // useEffect(() => {
        //   console.log("yyy");
        //   return () => {
        //     console.log("yyy");
        //   };
        // }, [props.user.name]);

        // useEffect() 是一个函数 两个参数
        // 第一个参数 是一个 函数(这个函数会返回一个新函数)
        // 第一个参数函数(这个函数会返回一个新函数)
        // 第二个参数是一个数组

        // useEffect(() => {
        //   console.log("useEffect", props.user, props.msg);
        //   console.log("Ajax 获取数据", props.msg);
        // });

        // 第一个函数 componentDidMount componentDidUpdate两个生命周期调用

        useEffect(() => {
          console.log("useEffect", props.user, props.msg);
          console.log("Ajax 获取数据", props.msg);
        }, [props.msg]);

        // 第二个函数  功能相当 shouldComponentUpdate

        return <p>name: {props.user.name}</p>;
      }

      function App(props) {
        const obj = { name: "nick", age: 17 };
        const [user, setUser] = useState(obj);
        const [msg, setMsg] = useState("hello");
        return (
          <div>
            <button
              onClick={() => {
                setUser(user ? null : obj);
              }}
            >
              Toggle
            </button>

            <button
              onClick={() => {
                setUser({ name: "mark", age: 17 });
              }}
            >
              changeUser
            </button>

            <button
              onClick={() => {
                setMsg("hello react");
              }}
            >
              changeMsg
            </button>
            {user && <User user={user} msg={msg} />}
          </div>
        );
      }

      ReactDOM.render(<App />, document.querySelector("#app"));
    </script>
  </body>
</html>
